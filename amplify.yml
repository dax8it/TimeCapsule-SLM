version: 1
env:
  variables:
    # Google Analytics 4 Configuration
    GA4_MEASUREMENT_ID: G-XXXXXXXXXX
    GA4_CONSOLE_LOGGING: false
frontend:
  phases:
    preBuild:
      commands:
        - echo "Starting SketchPad-SLM build process..."
        - echo "GA4 Measurement ID:" $GA4_MEASUREMENT_ID
    build:
      commands:
        - echo "Building SketchPad-SLM with AI integration..."
        - echo "Creating basic config.js file..."
        - echo 'window.AppConfig = {};' > config.js
        - echo "Build completed successfully!"
    postBuild:
      commands:
        - echo "Post-build: Optimizing assets..."
        - echo "âœ… SketchPad-SLM build completed!"
  artifacts:
    baseDirectory: .
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
  customHeaders:
    - pattern: '**/*'
      headers:
        Content-Security-Policy: "script-src 'self' 'unsafe-eval' 'unsafe-inline' https: data: blob:; style-src 'self' 'unsafe-inline' https: data:; connect-src 'self' https: wss:; img-src 'self' data: https: blob:; font-src 'self' data: https:; worker-src 'self' blob: data:; object-src 'none';"
        X-Frame-Options: SAMEORIGIN
        X-Content-Type-Options: nosniff
        Referrer-Policy: strict-origin-when-cross-origin
        Cache-Control: public, max-age=31536000
        X-SketchPad-Version: "2.2.0-Simplified"
    - pattern: '*.html'
      headers:
        Cache-Control: public, max-age=3600
        X-SketchPad-HTML: "CSP-Managed" 